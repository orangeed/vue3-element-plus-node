"use strict";
/**
 * @format
 * @Description: 获取swagger的命令
 * @Autho: luckybo
 * @Date:2019/9/26 17:49
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var chalk_1 = __importDefault(require("chalk"));
var lodash_1 = require("lodash");
var ConstName_1 = require("../configs/ConstName");
var swagger_1 = __importDefault(require("../lib/swagger"));
var Validate_1 = __importDefault(require("../lib/Validate"));
function run() {
    /** 校验配置文件*/
    var noError = new Validate_1.default().main(ConstName_1.TargetPath);
    if (!noError) {
        console.log(chalk_1.default.red('something is wrong.'));
        process.exit(0);
        return;
    }
    var config = require(ConstName_1.TargetPath);
    var defaultConfig = require(ConstName_1.DefaultConfigPath);
    var newConfig = lodash_1.merge(defaultConfig, config);
    var swagger = new swagger_1.default(newConfig);
    swagger
        .main()
        .then(function (result) {
        console.log(chalk_1.default.green("\u63A5\u53E3\u6587\u4EF6\u5DF2\u8F93\u51FA\u81F3: /" + newConfig.outputPath));
        process.exit(0);
    })
        .catch(function (e) {
        console.log(chalk_1.default.red(e));
    });
}
exports.default = run;
